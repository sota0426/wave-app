"use strict";(self.webpackChunkwave_app=self.webpackChunkwave_app||[]).push([[59],{59:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(43),n=s(749),r=s(711),o=s(292),i=s(408),l=(s(119),s(927)),c=s(579);function u(e){let{start:t,end:s,color:r,phaseShift:o,attenuation:l,frequency:u,speed:d,timeRef:h,isRunning:x}=e;const p=(0,a.useRef)(null),f=100,m=(0,a.useMemo)((()=>{const e=new Float32Array(303);for(let a=0;a<=f;a++){const n=a/f,r=t.clone().lerp(s,n);e[3*a]=r.x,e[3*a+1]=r.y,e[3*a+2]=r.z}return e}),[t,s]),g=(0,a.useMemo)((()=>{const e=new i.BufferGeometry;return e.setAttribute("position",new i.BufferAttribute(m,3)),e}),[m]);return(0,n.F)((()=>{if(!x||!p.current)return;const e=g.attributes.position,s=e.array;for(let a=0;a<=f;a++){const e=s[3*a],n=s[3*a+2],r=new i.Vector3(e,0,n),c=t.distanceTo(r),x=2*Math.exp(-c*l/300)*Math.sin(c*u-h.current*d+o);s[3*a+1]=x}e.needsUpdate=!0})),(0,c.jsx)("primitive",{object:new i.Line(g,new i.LineBasicMaterial({color:r})),ref:p})}function d(e){let{sourceDistance:t,period:s,speed:r,dot:o,attenuation:l,blackThreshold:d,phaseShift:h,isRunning:x,isSelectable:p,isExtracted:f,onPointSelected:m,selectedPoint:g}=e;const b=(0,a.useRef)(null),j=(0,a.useRef)(0),w=(0,a.useRef)(null),y=(0,a.useRef)(null),M=(0,a.useRef)(null),v=(0,a.useRef)(0),F=(0,a.useMemo)((()=>{const e=new i.PlaneGeometry(70,70,o,o);e.rotateX(-Math.PI/2);const t=new Float32Array(3*e.attributes.position.count);return e.setAttribute("color",new i.BufferAttribute(t,3)),e}),[o]);(0,n.F)(((e,a)=>{if(!x)return;j.current+=a;const n=1/s,o=new i.Vector3(t/2,0,0),c=new i.Vector3(-t/2,0,0);if(g){const e=new i.Vector3(g[0],g[1],g[2]),t=e.distanceTo(o),s=2*Math.exp(-t*l/300)*Math.sin(t*n-j.current*r),a=e.distanceTo(c),u=s+2*Math.exp(-a*l/300)*Math.sin(a*n-j.current*r+h);w.current&&(w.current.position.y=u),v.current=u}const u=3*s;if(j.current+=a,j.current>u&&(j.current=0),y.current){const e=2*Math.sin(-j.current*r);y.current.position.y=e}if(M.current){const e=2*Math.sin(-j.current*r+h);M.current.position.y=e}if(!f||!g){if(!b.current)return;const e=b.current.geometry.attributes.position.array,s=b.current.geometry.attributes.color.array,a=e.length/3,o=[t/2,0,0],i=[-t/2,0,0];for(let t=0;t<a;t++){const a=e[3*t],c=3*t+1,u=e[3*t+2],x=Math.sqrt(Math.pow(a-o[0],2)+Math.pow(u-o[2],2)),p=Math.sqrt(Math.pow(a-i[0],2)+Math.pow(u-i[2],2));let f=2*Math.exp(-x*l/300)*Math.sin(x*n-j.current*r);if(f+=2*Math.exp(-p*l/300)*Math.sin(p*n-j.current*r+h),e[c]=f,Math.abs(f)<d)s[3*t]=0,s[3*t+1]=0,s[3*t+2]=0;else{const e=(f+2)/4;s[3*t]=e,s[3*t+1]=.5,s[3*t+2]=1-e}}b.current.geometry.attributes.position.needsUpdate=!0,b.current.geometry.attributes.color.needsUpdate=!0,b.current.geometry.computeVertexNormals(),w.current&&g&&(w.current.position.y=e[1])}}));const k=e=>{if(!p)return;e.stopPropagation();const t=e.point;m([t.x,t.y,t.z])},N=new i.Vector3(t/2,0,0),S=new i.Vector3(-t/2,0,0);return(0,c.jsxs)(c.Fragment,{children:[!f&&(0,c.jsxs)("mesh",{ref:b,onPointerDown:k,children:[(0,c.jsx)("primitive",{object:F}),(0,c.jsx)("meshPhongMaterial",{vertexColors:!0,wireframe:!0,side:i.DoubleSide})]}),g&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(u,{start:N,end:new i.Vector3(g[0],g[1],g[2]),color:"red",phaseShift:0,attenuation:l,frequency:1/s,speed:r,timeRef:j,isRunning:x}),(0,c.jsx)(u,{start:S,end:new i.Vector3(g[0],g[1],g[2]),color:"blue",phaseShift:h,attenuation:l,frequency:1/s,speed:r,timeRef:j,isRunning:x})]}),g&&(0,c.jsxs)("mesh",{ref:w,position:new i.Vector3(g[0],g[1],g[2]),onPointerDown:k,children:[(0,c.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,c.jsx)("meshBasicMaterial",{color:"yellow"})]}),(0,c.jsxs)("mesh",{ref:y,position:N,children:[(0,c.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,c.jsx)("meshBasicMaterial",{color:"red"})]}),(0,c.jsxs)("mesh",{ref:M,position:S,children:[(0,c.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,c.jsx)("meshBasicMaterial",{color:"blue"})]})]})}function h(){const[e,t]=(0,a.useState)(20),[s,n]=(0,a.useState)(1),[i,u]=(0,a.useState)(2),[h,x]=(0,a.useState)(200),[p,f]=(0,a.useState)(20),[m,g]=(0,a.useState)(0),[b,j]=(0,a.useState)(0),[w,y]=(0,a.useState)(!0),[M,v]=(0,a.useState)(!0),[F,k]=(0,a.useState)(!1),[N,S]=(0,a.useState)(null),[P,R]=(0,a.useState)(null),C=i*s;return(0,c.jsxs)("div",{className:"p-4 max-w-full mx-auto",children:[(0,c.jsxs)("div",{className:"flex flex-wrap space-x-4 ",children:[(0,c.jsxs)("label",{className:"block text-black",children:["\u6ce2\u6e90\u306e\u8ddd\u96e2: ",e.toFixed(1)," (\u03bb = ",C.toFixed(2),")",(0,c.jsx)("input",{type:"range",min:"0",max:"30",step:"0.1",value:e,onChange:e=>t(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,c.jsxs)("label",{className:"block text-black",children:["\u5468\u671f: ",s.toFixed(2),(0,c.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:s,onChange:e=>n(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,c.jsxs)("label",{className:"block text-black",children:["\u901f\u3055: ",i.toFixed(2),(0,c.jsx)("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:i,onChange:e=>u(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})]}),(0,c.jsxs)("div",{className:"flex flex-wrap space-x-4",children:[(0,c.jsxs)("label",{className:"block text-black",children:["\u6e1b\u8870\u5ea6: ",p.toFixed(0),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:p,onChange:e=>f(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,c.jsxs)("label",{className:"block text-black",children:["\u30c9\u30c3\u30c8\u6570: ",h.toFixed(0),(0,c.jsx)("input",{type:"range",min:"50",max:"300",step:"10",value:h,onChange:e=>x(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,c.jsxs)("label",{className:"block text-black",children:["\u3053\u306e\u5909\u4f4d\u4ee5\u4e0b\u3092\u9ed2\u8272\u8868\u793a: ",m.toFixed(2),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:m,onChange:e=>g(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})]}),(0,c.jsxs)("div",{className:"flex flex-wrap space-x-4 mb-4",children:[(0,c.jsxs)("label",{className:"block text-black",children:["\u9752\u8272\u306e\u4f4d\u76f8\u306e\u9045\u308c: ",(180*b/Math.PI).toFixed(0),"\xb0 \uff08",(0,c.jsx)(l.InlineMath,{math:`${(b/Math.PI).toFixed(1)}\\pi`}),"\uff09",(0,c.jsx)("input",{type:"range",min:"0",max:"360",step:"30",value:(180*b/Math.PI).toFixed(0),onChange:e=>{const t=parseFloat(e.target.value)*Math.PI/180;j(t)},className:"w-full bg-gray-700 rounded"})]}),(0,c.jsx)("button",{onClick:()=>{y(!w)},className:"px-4 py-2 text-white bg-blue-500 rounded",children:w?"Stop":"Start"}),(0,c.jsxs)("label",{className:"flex items-center text-black",children:[(0,c.jsx)("input",{type:"checkbox",checked:M,onChange:e=>{v(e.target.checked),e.target.checked||(S(null),R(null),k(!1))},className:"mr-2"}),"\u70b9\u3092\u9078\u629e\u3059\u308b"]}),(0,c.jsx)("button",{onClick:()=>k(!F),className:"px-4 py-2 text-white bg-green-500 rounded",disabled:!N,children:F?"\u5143\u306b\u623b\u3059":"\u6ce2\u3092\u62bd\u51fa"})]}),(0,c.jsxs)("div",{className:"w-full h-screen bg-gray-900 relative",children:[(0,c.jsxs)(r.Hl,{className:"mx-auto w-full h-3/4",camera:{position:[0,30,30],fov:60},children:[(0,c.jsx)(o.N,{}),(0,c.jsx)("ambientLight",{intensity:.5}),(0,c.jsx)("pointLight",{position:[10,10,10],intensity:1}),(0,c.jsx)(d,{sourceDistance:e,period:s,speed:i,dot:h,attenuation:p,blackThreshold:m,phaseShift:b,isRunning:w,isSelectable:M,isExtracted:F,onPointSelected:t=>{S(t);const s=[e/2,0,0],a=[-e/2,0,0],n=Math.sqrt(Math.pow(t[0]-s[0],2)+Math.pow(t[2]-s[2],2)),r=Math.sqrt(Math.pow(t[0]-a[0],2)+Math.pow(t[2]-a[2],2)),o=Math.abs(n-r),i=n/C,l=r/C,c=o/C,u=Math.floor(c);R({distance1:n,distance2:r,distance1InWavelengths:i,distance2InWavelengths:l,difference:o,differenceInWavelengths:c,integerPart:u,fractionalPart:c-u})},selectedPoint:N})]}),P&&N&&(0,c.jsxs)("div",{style:{position:"absolute",top:"10px",left:"10px",color:"white",background:"rgba(0,0,0,0.5)",padding:"10px",pointerEvents:"none"},children:[(0,c.jsxs)("p",{children:["\u6ce2\u6e90(\u8d64)\u304b\u3089\u306e\u8ddd\u96e2: ",P.distance1.toFixed(2)," (",P.distance1InWavelengths.toFixed(2),"\u03bb)"]}),(0,c.jsxs)("p",{children:["\u6ce2\u6e90(\u9752)\u304b\u3089\u306e\u8ddd\u96e2: ",P.distance2.toFixed(2)," (",P.distance2InWavelengths.toFixed(2),"\u03bb)"]}),(0,c.jsxs)("p",{children:["\u8ddd\u96e2\u306e\u5dee: ",P.difference.toFixed(2)," (",P.differenceInWavelengths.toFixed(2),"\u03bb = ",P.integerPart,"\u03bb +"," ",P.fractionalPart.toFixed(2),"\u03bb)"]})]})]})]})}}}]);
//# sourceMappingURL=59.b97ae134.chunk.js.map